# --- ุงููุชุบูุฑุงุช ---

# ุงุณู ุงูุจุฑูุงูุฌ ุงูููุงุฆู
NAME = webserv

# ุงููููุจุงููุฑ ุฏูุงู C++
CXX = c++

# ุงูููุงุบุฒ ุฏูุงู ุงูููููพููุงุณููู: ููุฒูุฏู ูููู -MMD ู -MP ุจุงุด ูุตูุนู ูููุงุช ุงูุชุจุนูุฉ (dependencies)
# -I. ูุชููู ูููููุจุงููุฑ ูููุจ ุนูู ุงูููุฏุฑุฒ (.hpp) ุญุชู ูุงูุฏูุณู ุงูุญุงูู
CXXFLAGS = -std=c++98 -fsanitize=address -g3 -I. -MMD -MP

# ุงููููููุฏ ุจุงุด ููุณุญู ุงููููุงุช
RM = rm -f


# --- ุงููููุงุช ุงููุตุฏุฑูุฉ ูุงูุฃูุจุฌููุช (ุจุงูุชุดุงู ุชููุงุฆู) ---

# ุฌุจุฏ ููุง ูุงุน ุงููููุงุช ูู ููุณุงููู ุจู .cpp ูุงูุฏูุณู ุงูุญุงูู
SRCS = $(wildcard *.cpp)

# ุตูุน ูุงุฆุญุฉ ุฏูุงู ูููุงุช ุงูุฃูุจุฌููุช (.o) ุงูุทูุงูุง ูู ูุงุฆุญุฉ ูููุงุช ุงููุตุฏุฑ
OBJS = $(SRCS:.cpp=.o)

# ุตูุน ูุงุฆุญุฉ ุฏูุงู ูููุงุช ุงูุชุจุนูุฉ (.d) ูู ูุชุตุงูุจูุง ุงูููุงุบ -MMD
DEPS = $(SRCS:.cpp=.d)


# --- ุงูููุงุนุฏ (Rules) ---

# ุงููุงุนุฏุฉ ุงูุงูุชุฑุงุถูุฉ: ูู ูู ูุชุฎุฏู ูุงุด ูุชูุชุจ "make" ุจูุญุฏูุง
all: $(NAME)

# ุงููุงุนุฏุฉ ูู ูุชุตูุน ุงูุจุฑูุงูุฌ ุงูููุงุฆู:
# ููุชุฎุฏู ุญุชู ูููููู ูุงุน ูููุงุช ุงูุฃูุจุฌููุช (.o) ูุงุฌุฏูู
$(NAME): $(OBJS)
	@$(CXX) $(CXXFLAGS) -o $(NAME) $(OBJS)
	@echo "โ ุชู ุฅูุดุงุก ุจุฑูุงูุฌ Webserv ุจูุฌุงุญ!"

# ุงููุงุนุฏุฉ ูู ูุชูุณุญ ูููุงุช ุงูุฃูุจุฌููุช (.o) ููููุงุช ุงูุชุจุนูุฉ (.d)
clean:
	@$(RM) $(OBJS) $(DEPS)
	@echo "๐งน ุชู ุชูุธูู ูููุงุช ุงูุฃูุจุฌููุช ูุงูุชุจุนูุฉ."

# ุงููุงุนุฏุฉ ูู ูุชูุณุญ ููุดู (ุงูุฃูุจุฌููุช + ุงูุจุฑูุงูุฌ ุงูููุงุฆู)
fclean: clean
	@$(RM) $(NAME)
	@echo "๐ฅ ุชู ุงูุชูุธูู ุงููุงูู. ุงูุจุฑูุงูุฌ ุงูููุงุฆู ุชู ูุณุญู."

# ุงููุงุนุฏุฉ ูู ูุชุนุงูุฏ ุชุจูู ููุดู ูู ุงูุตูุฑ
re: fclean all

# --- ุฅุฏุฑุงุฌ ูููุงุช ุงูุชุจุนูุฉ ูููุงุนุฏ ููููุฉ ---

# ูุงุฏ ุงูุณุทุฑ ููููู ูู make ููุดู ููุฑุฃ ูุงุน ูููุงุช ุงูุชุจุนูุฉ (.d) ูู ุชุตูุนุงุช
# ุงูุนูุงูุฉ (-) ูุงูููู ูู ุจุงุด make ูุงูุบูุชุด ููุง ูููุงุด ูุงุฏ ุงููููุงุช ูุงููุฑุฉ ุงูุฃููู
-include $(DEPS)

# ูุงุฏู ููุงุนุฏ ููููุฉุ ููุชูุซูุด ูููุงุช ุญููููุฉ. ูููููู ูู make ุจุงุด ูุงูุชุฎูุทุด ููู ูุน ุดู ููู ุณููุชู "clean" ูุซูุง
.PHONY: all clean fclean re